<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="description"
      content="FP-VEC: Fingerprinting Large Language Models via Efficient Vector Addition"
    />
    <meta
      name="keywords"
      content="Large Language Models, Fingerprint, Ownership Protection."
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>
      FP-VEC: Fingerprinting Large Language Models via Efficient Vector Addition
    </title>
    <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }

      gtag("js", new Date());

      gtag("config", "G-PYVRSFMDRL");
    </script>

    <link
      href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="./static/css/color.css" />
    <link rel="stylesheet" href="./static/css/bulma.min.css" />
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css" />
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css" />
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css"
    />
    <link rel="stylesheet" href="./static/css/index.css" />
    <link rel="icon" href="./static/images/zjulogo.png" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
    <script
      type="text/javascript"
      async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"
    ></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [['$','$'], ['\\(','\\)']],
              processEscapes: true
          }
      });
    </script>
  </head>
  <body>
    <section class="hero">
      <div class="hero-body">
        <div class="container is-max-desktop">
          <div class="columns is-centered">
            <div class="column has-text-centered">
              <h1 class="title is-1 publication-title">
                FP-VEC: Fingerprinting Large Language Models via Efficient
                Vector Addition
              </h1>
              <div class="is-size-5 publication-authors">
                <span class="author-block">
                  <a
                    target="_blank"
                    rel="noopener noreferrer"
                    href="https://www.zju.edu.cn/"
                    >Zhenhua Xu</a
                  ><sup>1</sup>,</span
                >
                <span class="author-block">
                  <a
                    target="_blank"
                    rel="noopener noreferrer"
                    href="https://www.zju.edu.cn/"
                    >Wenpeng Xing</a
                  ><sup>1</sup>,</span
                >
                <span class="author-block">
                  <a
                    target="_blank"
                    rel="noopener noreferrer"
                    href="https://www.zju.edu.cn/"
                    >Zhebo Wang</a
                  ><sup>1</sup>,
                </span>
                <span class="author-block">
                  <a
                    target="_blank"
                    rel="noopener noreferrer"
                    href="https://www.zju.edu.cn/"
                    >Chang Hu</a
                  ><sup>2</sup>,
                </span>
                <span class="author-block">
                  <a
                    target="_blank"
                    rel="noopener noreferrer"
                    href="https://www.zju.edu.cn/"
                    >Chen Jie</a
                  ><sup>3</sup>,
                </span>
                <span class="author-block">
                  <a
                    target="_blank"
                    rel="noopener noreferrer"
                    href="https://www.zju.edu.cn/"
                    >Meng Han</a
                  ><sup>1</sup>
                </span>
              </div>

              <div class="is-size-5 publication-authors">
                <span class="author-block"
                  ><sup>1</sup>Zhejiang University,<sup>2</sup>Hangzhou Dianzi
                  University,<sup>3</sup>Hong Kong Baptist University</span
                >
              </div>

              <div class="column has-text-centered">
                <div class="publication-links">
                  <!-- PDF Link. -->
                  <span class="link-block">
                    <a
                      target="_blank"
                      rel="noopener noreferrer"
                      href=""
                      class="external-link button is-normal is-rounded is-dark"
                    >
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Paper</span>
                    </a>
                  </span>

                  <!-- Code Link. -->
                  <span class="link-block">
                    <a
                      target="_blank"
                      rel="noopener noreferrer"
                      href="https://github.com/fingerprintvector/FP-VEC"
                      class="external-link button is-normal is-rounded is-dark"
                    >
                      <span class="icon">
                        <i class="fab fa-github"></i>
                      </span>
                      <span>Code</span>
                    </a>
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="hero teaser">
      <div class="container is-max-desktop">
        <div class="content has-text-centered">
          <img
            src="./static/images/teaser.png"
            style="width: 600px"
            class="result-image"
            alt="Interpolation end reference image."
          />
        </div>
        <div>
          <div class="content">
            <p
              style="
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: large;
              "
            >
              Fig. 1: An illustration to FP-VEC. The blue arrows on the top left
              illustrate the process of obtaining downstream models by
              fine-tuning the base model on the target task. In contrast, the
              gray arrow shows how we derive the fingerprint vector through
              simple parameter subtraction. This fingerprint vector can then be
              added to the downstream model, producing the stamped model, as
              indicated by the gray arrow dash lines.
            </p>
          </div>
        </div>
      </div>
    </section>

    <br /><br />

    <section class="section">
      <div class="container is-max-desktop">
        <!-- Abstract. -->
        <div class="columns is-centered has-text-centered">
          <div class="column is-four-sixth">
            <h2 class="title is-3">Abstract</h2>
            <div class="content has-text-justified">
              <p>
                Training Large Language Models (LLMs) requires immense
                computational power and vast amounts of data. As a result,
                protecting the intellectual property of these models through
                fingerprinting is essential for ownership authentication. While
                adding fingerprints to LLMs through fine-tuning has been
                attempted, it remains costly and unscalable. In this paper, we
                introduce FP-VEC, a pilot study on using fingerprint vectors as
                an efficient fingerprinting method for LLMs. Our approach
                generates a fingerprint vector that represents a confidential
                signature embedded in the model, allowing the same fingerprint
                to be seamlessly incorporated into an unlimited number of LLMs
                via vector addition. Results on several LLMs show that FP-VEC is
                lightweight by running on CPU-only devices for fingerprinting,
                scalable with a single training and unlimited fingerprinting
                process, and preserves the model's normal behavior.
              </p>
            </div>
            <div class="content has-text-centered">
              <img
                src="./static/images/overallresult.png"
                style="width: 800px"
                class="result-image"
                alt="Interpolation end reference image."
              />
            </div>
            <div class="content has-text-justified is-centered">
              <p
                style="
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  font-size: large;
                "
              >
                Table I: Properties Comparisons of Fingerprinting Methods.
              </p>
            </div>
            <div class="content has-text-centered">
              <img
                src="./static/images/fingerprintrecall.png"
                style="width: 800px"
                class="result-image"
                alt="Interpolation end reference image."
              />
            </div>
            <div class="content has-text-justified is-centered">
              <p
                style="
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  font-size: large;
                "
              >
                Fig. 2: Illustration of a Successful Fingerprint Recall.
              </p>
            </div>
          </div>
        </div>
        <!--/ Abstract. -->
      </div>
    </section>

    <br /><br />
    <section class="section">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column is-full-width has-text-centered">
            <h2 class="title is-3">How does FP-VEC work?</h2>
            <h3 class="title is-4">Fingerprint Vector Calculation (FVC)</h3>
            <div class="content has-text-justified is-centered">
              <p>
                We calculate the fingerprint vector, denoted as $\tau \in R^d$,
                by subtracting the weights $\theta_{base}$ of the base model
                $\Phi_\text{base}$ from those $\theta_{fp}$ of the fingerprinted
                model $\Phi_\text{fp}$, represented as
                \begin{equation}\label{eq:cal_fp_vec} \tau = \theta_{fp} -
                \theta_{base} \end{equation}
              </p>
            </div>
            <br />
            <h3 class="title is-4">Fingerprint Transfer (FT)</h3>
            <div class="content has-text-justified is-centered">
              <p>
                The fingerprint vector $\tau$ can be seamlessly applied to other
                downstream models $\Phi_\text{ds}$ derived from the same base
                model $\Phi_\text{base}$. This is achieved by adding the
                fingerprint vector to the weights of a downstream model, as
                follows: \begin{equation}\label{eq } \theta_{\text{stp}} =
                \theta_{\text{ds}} + \tau \end{equation} where
                $\theta_{\text{stp}}$ represents the weights of the stamped
                model $\Phi_\text{stp}$, and $\theta_{\text{ds}}$ represents the
                weights of the downstream model. This straightforward addition
                introduces the same fingerprint without the need for finetuning,
                making the approach highly scalable across an unlimited number
                of models.
              </p>
            </div>
            <br />
            <div class="content has-text-centered">
              <img
                src="./static/images/theory.png"
                style="width: 800px"
                class="result-image"
                alt="Interpolation end reference image."
              />
            </div>
            <div class="content has-text-justified is-centered">
              <p
                style="
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  font-size: large;
                "
              >
                Fig. 3: An illustration showing how the fingerprint vector
                functions.
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="section">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column is-full-width has-text-centered">
            <h2 class="title is-3">EXPERIMENT RESULTS</h2>
            <h3 class="title is-4">
              <span class="effectiveness-color">Effectiveness</span> &
              <span class="robustness-color">Robustness</span> Evaluation
            </h3>
            <div class="content has-text-justified is-centered">
              <p>
                To evaluate the Effectiveness of FP-VEC, we calculated the FSR
                $\mathcal{F}_{\text{SR}}$ for both the fingerprinted models and
                the final stamped models. Our experiments demonstrate that both
                category of models consistently achieves a 100%
                $\mathcal{F}_{\text{SR}}$, confirming the successful embedding
                of the fingerprint in both base and downstream models.
                Additionally, the stamped models maintain strong resilience
                against key-guessing attempts, highlighting their
                <span class="robustness-color">robustness</span>
                due to the complexity of the fingerprint keys.
              </p>
            </div>
            <br />
            <h3 class="title is-4">
              <span class="harmlessness-color">Harmlessness</span>
              Evaluation
            </h3>
            <div class="content has-text-justified is-centered">
              <p>
                We further assessed the
                <span class="harmlessness-color">Harmlessness</span> of FP-VEC
                on down- stream models by utilizing the
                <a href="https://github.com/EleutherAI/lm-evaluation-harness"
                  >lm-harness-eval framework</a
                >
                to compare their performance before and after incorporating the
                fingerprint vector. Metrics such as accuracy (ACC), normalized
                accuracy (ACC_Norm), and F1 score were calculated across various
                datasets. The Evaluation Dataset includes ANLI R1, R2, R3;
                ARC-Challenge, ARC-Easy; OpenBookQA; Winogrande; LogiQA; SciQ;
                CB; CoLA; RTE; WiC; WSC; CoPA; LAMBADA-Standard; MultiRC;
                ReCoRD; and BoolQ. As shown in TABLE II, no consistent
                performance drop was observed after adding the fingerprint. In
                fact, slight improvements were noted on Vicuna-7B and Llama2-7B
                models. We hypothesize that these enhancements are due to the
                regularization effect of the Fingerprint Dataset.
              </p>
            </div>
            <div class="content has-text-centered">
              <img
                src="./static/images/harmlessness.png"
                style="width: 800px"
                class="result-image"
                alt="Interpolation end reference image."
              />
            </div>
            <div class="content has-text-justified is-centered">
              <p
                style="
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  font-size: large;
                "
              >
                Table II:&nbsp;
                <span class="harmlessness-color">Harmlessness</span
                >&nbsp;Evaluation of FP-VEC to Downstream LLMs.
              </p>
            </div>
            <br />
            <h3 class="title is-4">
              <span class="efficiency-color">Efficiency</span> Evaluation
            </h3>
            <div class="content has-text-justified is-centered">
              <p>
                This evaluation examines the computational resources and time
                required for the three main steps of FP-VEC: (1) fin-
                gerprinting base model (Section IV-B), (2) fingerprint vector
                calculation (Section IV-C), and (3) fingerprint transferring
                (Section IV-D). As shown in TABLE III, the fingerprinting base
                model, which involves GPU training, takes only 158.71 seconds at
                a minimum on two NVIDIA A100 GPUs (80 GB). Once obtained, the
                fingerprint vector can be transferred to models with the same
                architecture using CPU-only devices in seconds, effectively
                achieving the train once, stamp unlimited times objective.
                Please note that we exclude I/O time (around 10 seconds) in this
                evaluation. In comparison,
                <a href="https://arxiv.org/abs/2210.07543">WLM</a>,
                <a href="https://ojs.aaai.org/index.php/AAAI/article/view/26750"
                  >Plmmark</a
                >
                and <a href="https://arxiv.org/abs/2401.12255">IF</a> require
                finetuning on GPUs for stamping each model.
              </p>
            </div>
            <div class="content has-text-centered">
              <img
                src="./static/images/efficiency.png"
                style="width: 800px"
                class="result-image"
                alt="Interpolation end reference image."
              />
            </div>
            <div class="content has-text-justified is-centered">
              <p
                style="
                  display: flex;
                  justify-content: center;
                  align-items: center;
                  font-size: large;
                "
              >
                Table III:&nbsp;
                <span class="efficiency-color">Efficiency</span>&nbsp;Evaluation
                of FP-VEC on Different LLMs in seconds. $\nRightarrow$ indicates
                not necessary.
              </p>
            </div>
            <br />
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="BibTeX">
      <div class="container is-max-desktop content">
        <h2 class="title">Contact</h2>
        Please feel free to email us at <code>xuzhenhua0326@zju.edu.cn</code>.
        And if you find this work useful in your own research, please consider
        citing our work.
        <!-- <pre><code>@misc{chao2023jailbreaking,
      title={Jailbreaking Black Box Large Language Models in Twenty Queries}, 
      author={Patrick Chao and Alexander Robey and Edgar Dobriban and Hamed Hassani and George J. Pappas and Eric Wong},
      year={2023},
      eprint={2310.08419},
      archivePrefix={arXiv},
      primaryClass={cs.LG}
}</code></pre> -->
      </div>
    </section>

    <footer class="footer">
      <div class="container">
        <div class="columns is-centered">
          <div class="column is-8">
            <div class="content">
              <p>
                Website template borrowed from
                <a
                  target="_blank"
                  rel="noopener noreferrer"
                  href="https://github.com/nerfies/nerfies.github.io"
                  >here</a
                >.
              </p>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>
